[2026-01-16 13:32:59,350] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 14:03:09,631] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 14:03:20,444] ERROR in app:875 [KD010]: Exception on /login [POST]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 118, in decorated_function
    response = f(*args, **kwargs)
  File "D:\CRM STDD\app.py", line 200, in login
    return redirect(url_for('executive_bp.ceo_cockpit_dashboard'))
                    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\helpers.py", line 239, in url_for
    return current_app.url_for(
           ~~~~~~~~~~~~~~~~~~~^
        endpoint,
        ^^^^^^^^^
    ...<4 lines>...
        **values,
        ^^^^^^^^^
    )
    ^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1121, in url_for
    return self.handle_url_build_error(error, endpoint, values)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1110, in url_for
    rv = url_adapter.build(  # type: ignore[union-attr]
        endpoint,
    ...<3 lines>...
        force_external=_external,
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\werkzeug\routing\map.py", line 924, in build
    raise BuildError(endpoint, values, method, self)
werkzeug.routing.exceptions.BuildError: Could not build url for endpoint 'executive_bp.ceo_cockpit_dashboard'. Did you mean 'executive_bp.ceo_cockpit_page' instead?
[2026-01-16 14:04:41,169] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 41, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 89, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 20, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=session.get('user_context') # Truyền context nếu base.html cần
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 404, in top-level template code
    {% block header %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 87, in block 'header'
    {% if user_context.role == 'ADMIN' or user_context.can('THEME_DARK') %}
    ^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'None' has no attribute 'can'
[2026-01-16 14:06:47,095] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 14:06:53,544] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 41, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 89, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 25, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # Truyền đúng object User vào template
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 404, in top-level template code
    {% block header %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 87, in block 'header'
    {% if user_context.role == 'ADMIN' or user_context.can('THEME_DARK') %}
    ^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'None' has no attribute 'can'
[2026-01-16 14:14:47,603] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 41, in decorated_function
    data = db.get_data(query, (user_code,))
    ^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 89, in decorated_function
    for file in files:
    
  File "D:\CRM STDD\blueprints\executive_bp.py", line 25, in ceo_cockpit_page
    # [FIX & FAIL-SAFE] Lấy User Context
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        try:
    
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 404, in top-level template code
    {% block header %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 87, in block 'header'
    {% if user_context.role == 'ADMIN' or user_context.can('THEME_DARK') %}
    ^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'None' has no attribute 'can'
[2026-01-16 14:14:57,303] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 14:15:14,174] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:15:14,801] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 66, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 113, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 40, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 404, in top-level template code
    {% block header %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 87, in block 'header'
    {% if user_context.role == 'ADMIN' or user_context.can('THEME_DARK') %}
    ^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'None' has no attribute 'can'
[2026-01-16 14:17:47,875] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 14:17:51,544] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:17:51,546] WARNING in executive_bp:54 [KD010]: CEO Cockpit: Không load được User Context! Sử dụng Dummy User.
[2026-01-16 14:17:52,088] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 66, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 113, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 491, in top-level template code
    {% block content %}{% endblock %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 114, in block 'content'
    invData: {{ inventory_chart_data | tojson | safe }},
    ^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\filters.py", line 1721, in do_tojson
    return htmlsafe_json_dumps(value, dumps=dumps, **kwargs)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 669, in htmlsafe_json_dumps
    dumps(obj, **kwargs)
    ~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\json\provider.py", line 179, in dumps
    return json.dumps(obj, **kwargs)
           ~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
          ~~~~~~^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\json\provider.py", line 121, in _default
    raise TypeError(f"Object of type {type(o).__name__} is not JSON serializable")
TypeError: Object of type Undefined is not JSON serializable
[2026-01-16 14:19:54,732] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 14:19:59,666] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:19:59,669] WARNING in executive_bp:54 [KD010]: CEO Cockpit: Không load được User Context! Sử dụng Dummy User.
[2026-01-16 14:20:00,793] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:20:25,417] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:20:26,298] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:20:28,384] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:20:30,153] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:20:38,753] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 14:20:39,850] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 15:21:03,678] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 15:21:07,328] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 15:21:08,724] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 15:21:13,522] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 15:21:13,523] WARNING in executive_bp:54 [KD010]: CEO Cockpit: Không load được User Context! Sử dụng Dummy User.
[2026-01-16 15:21:14,933] ERROR in utils:62 [KD010]: Login Check Error: 'PASSWORD'
[2026-01-16 15:23:45,484] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 15:26:59,303] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 15:27:10,840] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 90, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 162, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 404, in top-level template code
    {% block header %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 96, in block 'header'
    {% if user_context and (user_context.role == 'ADMIN' or user_context.can('THEME_DARK')) %}
    ^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'can'
[2026-01-16 15:29:01,163] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 90, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 162, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 404, in top-level template code
    {% block header %}
    ^^^^^^^^^^^^^^^^^
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 96, in block 'header'
    {#
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'can'
[2026-01-16 15:29:10,366] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 15:29:12,705] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 90, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 162, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 149, in render_template
    template = app.jinja_env.get_or_select_template(template_name_or_list)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1087, in get_or_select_template
    return self.get_template(template_name_or_list, parent, globals)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1016, in get_template
    return self._load_template(name, globals)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 975, in _load_template
    template = self.loader.load(self, name, self.make_globals(globals))
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\loaders.py", line 138, in load
    code = environment.compile(source, name, filename)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 771, in compile
    self.handle_exception(source=source_hint)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 118, in template
    {% endif %}
    ^^^^^^^^^
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endblock'. The innermost block that needs to be closed is 'block'.
[2026-01-16 15:29:17,168] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 90, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 162, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 149, in render_template
    template = app.jinja_env.get_or_select_template(template_name_or_list)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1087, in get_or_select_template
    return self.get_template(template_name_or_list, parent, globals)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1016, in get_template
    return self._load_template(name, globals)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 975, in _load_template
    template = self.loader.load(self, name, self.make_globals(globals))
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\loaders.py", line 138, in load
    code = environment.compile(source, name, filename)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 771, in compile
    self.handle_exception(source=source_hint)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 118, in template
    {% endif %}
    ^^^^^^^^^
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endblock'. The innermost block that needs to be closed is 'block'.
[2026-01-16 15:29:23,885] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 90, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 162, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 149, in render_template
    template = app.jinja_env.get_or_select_template(template_name_or_list)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1087, in get_or_select_template
    return self.get_template(template_name_or_list, parent, globals)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1016, in get_template
    return self._load_template(name, globals)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 975, in _load_template
    template = self.loader.load(self, name, self.make_globals(globals))
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\loaders.py", line 138, in load
    code = environment.compile(source, name, filename)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 771, in compile
    self.handle_exception(source=source_hint)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 118, in template
    {% endif %}
    ^^^^^^^^^
jinja2.exceptions.TemplateSyntaxError: Encountered unknown tag 'endif'. Jinja was looking for the following tags: 'endblock'. The innermost block that needs to be closed is 'block'.
[2026-01-16 15:31:40,087] INFO in logger_setup:56 [System]: Titan OS Startup: Hệ thống Logging đã kích hoạt.
[2026-01-16 15:31:47,509] ERROR in app:875 [KD010]: Exception on /ceo_cockpit [GET]
Traceback (most recent call last):
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "D:\CRM STDD\utils.py", line 90, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\utils.py", line 162, in decorated_function
    return f(*args, **kwargs)
  File "D:\CRM STDD\blueprints\executive_bp.py", line 57, in ceo_cockpit_page
    return render_template(
        'ceo_cockpit.html',
    ...<2 lines>...
        user_context=user_context  # [SAFE] Đảm bảo biến này luôn là Object, không bao giờ None
    )
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 1295, in render
    self.environment.handle_exception()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "D:\CRM STDD\templates\ceo_cockpit.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "D:\CRM STDD\templates\base.html", line 495, in top-level template code
    {% set can_use_bot = (user_context.role == 'ADMIN') or (user_context.can('USE_CHATBOT')) or (user_level >= 5) %}
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ASUS TUF F15\AppData\Local\Programs\Python\Python314\Lib\site-packages\jinja2\utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'dict object' has no attribute 'can'
